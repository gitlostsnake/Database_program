import sqlite3


def connect():
    conn = sqlite3.connect("road_works.db")
    cur = conn.cursor()
    cur.execute("""
                CREATE TABLE IF NOT EXISTS TMvehicles
                (id INTEGER PRIMARY KEY, FleetNo TEXT,
                RegistrationNo TEXT, WeightLimit TEXT)
                """)
    conn.commit()
    conn.close()


def insert(FleetNo, RegistrationNo, WeightLimit):
    conn = sqlite3.connect("road_works.db")
    cur = conn.cursor()
    cur.execute("INSERT INTO TMvehicles VALUES (NULL, ?,?,?)",
                (FleetNo, RegistrationNo, WeightLimit))
    conn.commit()
    conn.close()


def view():
    conn = sqlite3.connect("road_works.db")
    cur = conn.cursor()
    cur.execute("SELECT * FROM TMvehicles")
    rows = cur.fetchall()
    conn.close()
    return rows


def delete(id):
    conn = sqlite3.connect("road_works.db")
    cur = conn.cursor()
    cur.execute("DELETE FROM TMvehicles WHERE id=?", (id,))
    conn.commit()
    conn.close()


def update(id, FleetNo, RegistrationNo, WeightLimit):
    conn = sqlite3.connect("road_works.db")
    cur = conn.cursor()
    cur.execute("""
                UPDATE TMvehicles SET FleetNo=?, RegistrationNo=?,
                WeightLimit=? WHERE id=?""",
                (FleetNo, RegistrationNo, WeightLimit, id))
    conn.commit()
    conn.close()


def vieweverything():
    conn = sqlite3.connect("road_works.db")
    cur = conn.cursor()
    cur.execute('SELECT * FROM TMvehicles')
    [print(row) for row in cur.fetchall()]

connect()
